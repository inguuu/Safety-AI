
# 💙 MVP 제작안: 건강검진 안내 AI 서비스



## 📌 1. 프로젝트 개요

### 🗂️ 프로젝트 연혁 및 현황

| 연도 | 주요 내용 |
|------|----------|
| **2022년** | 건강검진 본인/가족 신청 시스템 구축 |
| **2023년** | 검진 센터 시스템 반영 및 센터 간 결과 연계 기능 도입 |
| **2024년** | 병원 안내 시스템 개발, 건강검진 결과 시각화, 건강 다이어리 기능 추가 |
| **2025년** | 건강검진 AI Agent(Chat-Bot) 개발, 독감예방접종 신청 기능 연계 |

### 📝 운영 현황 요약

전국 약 300개 센터의 비정형 자료(PDF, Word, Excel 등)를 수집하여, 담당자들이 이를 시스템 기준에 맞춰 DB로 수작업 가공

→ 이로 인해 정보 누락/불균형 문제 존재, LLM을 활용한 유연한 응답 처리로 보완을 목표

### ✅ 문제 정의
- 기존 건강검진 AI 에이전트는 **형식적이고 키워드 기반**으로만 작동하며 **자연어 질의 해석 불가**
- 관련 자료는 **PDF, DB, 웹 등 다양한 포맷**에 자료라 정형화 시 검색 내용이 부족함
- 사용자 입장에서 검사항목, 센터 정보 등의 정보에 대해 **실질적인 질의 응답이 어려움**


### 🎯 대상 사용자
- **건강검진 정보 제공자** (센터 담당자, 기업 보건관리자)
- **건강검진 대상자** (직원)

### 💡 솔루션 개요
- 자연어로 건강검진에 대한 질의를 입력하면, AI가 유사어 치환 및 전처리를 통해 관련 정보를 검색하고, 필요시 GPT로 직접 응답
- **RAG 기반 챗봇**으로 정확하고 근거 기반의 답변 제공

---


## 📊 2. 시스템 아키텍처


<img width="1653" height="701" alt="image" src="https://github.com/user-attachments/assets/d6886ff8-d3ad-45ba-a4c6-5c203242bae0" />



### ✅ 주요 구성 요소
- **Azure AI Search** (Indexer, Skillset, Index)  
- **Azure OpenAI (GPT-4.1-mini)**  
- **Streamlit UI (ChatGPT 스타일)**  
- **Blob Storage(Text, OCR)**
- **Azure Database for MySQL(전처리, 센터정보 등)**

---

### 📂 프로젝트 구조 요약

```plaintext
📁 ai-health-agent/
├── app.py                  # app
├── config.py               # 환경 변수 또는 공통 설정 관리
├── preprocess.py           # 유저 입력 전처리
├── search_handler.py       # Azure Search 쿼리 핸들링
├── llm_handler.py          # OpenAI or Azure OpenAI LLM 호출 관리
├── ui_components.py        # UI, CSS 분리 
├── index_setup.py          # Azure Search Index 구성
├── datasource_indexer.py   # DataSource, Skillset, Indexer 자동화
├── run_indexer.py          # 인덱서 수동 실행
├── UploadDocs.cmd          # 문서 업로드 스크립트
├── .env                    # 환경변수 설정
└── README.md               # 💬 현재 문서
```

## 🧠 3. 핵심 기술 포인트

### ✅ 전처리 기반 유사어 치환 
-  ("진료", "검사", "검진") ("센터", "기관", "병원") 등 다양하게 사용 됨 

- "진료", "검사", "검진" 등 의미가 유사한 단어 그룹을 DB에 다대다(N:N) 매핑 형태로 저장

- 사용자 입력 문장에서 이 단어들을 대응 가능한 다른 표현으로 자연스럽게 치환

- 치환은 GPT를 활용하여 문맥을 고려한 문장 재구성 방식으로 수행

- 예: 검사 용어를 사용하는 센터에서도 "검진 항목 알려줘" → "검사 항목에 대해 설명해줘"로 유연하게 변환

### ✅ AI Search 결과 + LLM 결과 통합

```plaintext
┌────────────┐
│ 사용자 질문 │
└─────┬──────┘
      ▼
┌─────────────────────────────────────────────────────────────┐
│ 🔁 전처리: DB 유사어 테이블 목록으로 치환 후 프롬프트 생성      │
└─────┬───────────────────────────────────────────────────────┘
      ▼
┌──────────────────────────────┐
│ 🔎 Azure AI Search 호출      │
└─────┬────────────────────────┘
      │          └─(없으면)
      ▼                         ▼
┌────────────┐         ┌────────────────────┐
│ 문서 검색 결과 │         │  GPT 직접 응답 생성    │
└─────┬──────┘         └─────────┬──────────┘
      ▼                         ▼
┌────────────────────────────────────────┐
│ 💬 근거 기반 답변 생성 및 응답 반환     │
└────────────────────────────────────────┘
```

### ✅ 커스텀 프롬포트 제공

| 스타일명       | `temperature` | `top_p` | `max_tokens` | 특성 설명                    |
| ---------- | ------------- | ------- | ------------ | ------------------------ |
| **정확도 우선** | `0.2`         | `0.7`   | `600`        | 신뢰도 높은 단정적인 응답, 불확실성 최소화 |
| **빠르게**    | `0.2`         | `0.6`   | `350`        | 핵심만 빠르게 전달, 간결한 문장 위주    |
| **간략하게**   | `0.3`         | `0.7`   | `400`        | 요점 정리형 응답, 불필요한 배경 설명 제거 |
| **상세하게**   | `0.7`         | `0.9`   | `800`        | 친절하고 자세한 설명, 예시 및 배경 포함  |

### ✅ RAG 구조 구현
- Azure Search → 근거 문서 검색  
- GPT는 문서 기반으로만 응답 (`GROUNDED_PROMPT`)  
- 검색 실패 시 GPT가 **유연하게 직접 응답**

### ✅ Azure AI Search Skillset
- PDF 문서 내 이미지에서 텍스트 추출하는 **OCR Skill** 포함
- 자동 Indexer 생성 → Blob 내 신규 문서 자동 색인화

### ✅ 운영 자동화 스크립트 구성
- `UploadDocs.cmd` : 문서 업로드  
- `index_setup.py` : 인덱스 초기 세팅  
- `datasource_indexer.py` : DataSource, Skillset, Indexer 자동 생성 및 실행  
- `run_indexer.py` : 수동 실행용 스크립트

---




## 🖥️ 4. 라이브 데모

<img width="1419" height="935" alt="image" src="https://github.com/user-attachments/assets/3b05a274-e075-4a7e-bf7e-9d0b88e2c7f9" />



[👉 웹 서비스 시연 바로가기](https://igigwebapp-d2bcajc4fyfwagbp.koreacentral-01.azurewebsites.net)

[🎥 데모 영상 보기](https://drive.google.com/file/d/1_WNDX4MQNysxOT_uG1zzxDhMtWODmJwM/view?usp=drive_link)

---

## 🏗️ 실현 가능성 

- 실제 3만 명(임직원+가족) 이상이 사용하는 현업 시스템 기반
- 건강검진 미이행 시 기업 책임 문제 → 시스템 연동 필요성 증가
- 1인당 100만 원 정도의 비용이 드는 검진의 효율성 관리 필요
- KT 등 외부 근무자 비율 높은 기업에서 특수검진, 우선케어 등 니즈 증가
- 2026년, 8개 그룹사 신규 안전보건시스템 구축 예정
---

## 🔭 5. 향후 개선 및 확장 계획

| 개선 항목                | 설명 |
|-------------------------|------|
| ✅ 유사어 DB 확장         | 산업군 및 의료기관별 다양한 사용자 언어 반영 |
| ✅ 시스템 연동      | 검진신청 및 검진결과를 활용하여 개발 범위 확장 |
| ✅ 다운로드 기능 추가     | 검색 결과 기반 제안서, 리포트 다운로드 기능 제공 |
| ✅ 보안 및 인증 강화      | Apa GW, KeyVault, EntraId 연결 |
| ✅ EntraId를 활용하여 개인 별 결과 데이터 활용  | 검진 항목, 센터 등 추천, 결과 레포팅  |

---



